<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="single-spa Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="single-spa Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-138683004-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="single-spa" href="/opensearch.xml">
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/racial-equity-banner@1.0.3/racial-equity-banner-bottom.js"></script>
<script src="/js/index.js"></script><title data-react-helmet="true">The Recommended Setup | single-spa</title><meta data-react-helmet="true" property="og:image" content="https://single-spa.github.io/id.single-spa.js.org/img/docusaurus.png"><meta data-react-helmet="true" name="twitter:image" content="https://single-spa.github.io/id.single-spa.js.org/img/docusaurus.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for single-spa"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="5.x"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-5.x"><meta data-react-helmet="true" property="og:title" content="The Recommended Setup | single-spa"><meta data-react-helmet="true" name="description" content="The single-spa npm package is not opinionated about your build tools, CI process, or local development workflow. However, to implement single-spa you will have to figure all of those things out (and more). To help you decide how to approach these problems, the single-spa core team has put together a &quot;recommended setup&quot; that gives an opinionated approach to solving the practical problems of microfrontends."><meta data-react-helmet="true" property="og:description" content="The single-spa npm package is not opinionated about your build tools, CI process, or local development workflow. However, to implement single-spa you will have to figure all of those things out (and more). To help you decide how to approach these problems, the single-spa core team has put together a &quot;recommended setup&quot; that gives an opinionated approach to solving the practical problems of microfrontends."><meta data-react-helmet="true" property="og:url" content="https://single-spa.github.io/id.single-spa.js.org/docs/recommended-setup"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo-blue-favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://single-spa.github.io/id.single-spa.js.org/docs/recommended-setup"><link rel="stylesheet" href="/styles.121a4747.css">
<link rel="preload" href="/styles.0f039106.js" as="script">
<link rel="preload" href="/runtime~main.fe7e5f5d.js" as="script">
<link rel="preload" href="/main.ff1eb78c.js" as="script">
<link rel="preload" href="/1.55780ba8.js" as="script">
<link rel="preload" href="/2.953e0b72.js" as="script">
<link rel="preload" href="/108.228883a7.js" as="script">
<link rel="preload" href="/561a3eb1.cf6dff04.js" as="script">
<link rel="preload" href="/17896441.c0dd0527.js" as="script">
<link rel="preload" href="/b025bb67.45bb851d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo-white-bgblue.svg" alt="single-spa Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-white-bgblue.svg" alt="single-spa Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">single-spa</strong></a><a class="navbar__item navbar__link" style="white-space:nowrap;padding:0.25rem 0.5rem 0.2rem 0.25rem;font-size:calc(0.9 * var(--ifm-font-size-base));text-decoration:underline" href="/versions">5.x</a><a class="navbar__item navbar__link" href="/docs/faq/">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/help/">Help</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a href="https://opencollective.com/single-spa" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Donate</a><a href="https://github.com/single-spa/single-spa" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a class="navbar__item navbar__link" href="/languages">ç®€Ð–à¤¹à¤¿ Languages</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-white-bgblue.svg" alt="single-spa Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-white-bgblue.svg" alt="single-spa Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">single-spa</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" style="white-space:nowrap;padding:0.25rem 0.5rem 0.2rem 0.25rem;font-size:calc(0.9 * var(--ifm-font-size-base));text-decoration:underline" href="/versions">5.x</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq/">FAQ</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/help/">Help</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/">Blog</a></li><li class="menu__list-item"><a href="https://opencollective.com/single-spa" target="_blank" rel="noopener noreferrer" class="menu__link">Donate</a></li><li class="menu__list-item"><a href="https://github.com/single-spa/single-spa" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/languages">ç®€Ð–à¤¹à¤¿ Languages</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started-overview">Overview of single-spa</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/examples">Resources</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/single-spa-playground">Playground</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/videos">Videos</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/create-single-spa">create-single-spa</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concept: Microfrontend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/microfrontends-concept">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/module-types">Microfrontend Types</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concept: Root Config</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/configuration">Configuring single-spa</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concept: Application</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/building-applications">single-spa applications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/separating-applications">Splitting applications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/migrating-existing-spas">Migrating existing code</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concept: Parcel</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/parcels-overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Layout Engine</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/layout-overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/layout-definition">Layout Definition</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/layout-api">API</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">The Recommended Setup</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/recommended-setup">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api">Applications API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/parcels-api">Parcels API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Ecosystem</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-react">React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-vue">Vue</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-angular">Angular</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-angularjs">AngularJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-cycle">Cycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-ember">Ember</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-inferno">Inferno</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-preact">Preact</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-svelte">Svelte</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-riot">Riot</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-backbone">Backbone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-html-web-components">HTML / Web Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-leaked-globals">Leaked globals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-dojo">Dojo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-alpinejs">AlpineJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-vite">Vite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ecosystem-snowpack">Snowpack</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Server Side Rendering (New)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ssr-overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dev Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/devtools">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contributing-overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/code-of-conduct">Code of Conduct</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><div><span class="badge badge--secondary">Version: 5.x</span></div><header><h1 class="docTitle_Oumm">The Recommended Setup</h1></header><div class="markdown"><p>The single-spa npm package is not opinionated about your build tools, CI process, or local development workflow. However, to implement single-spa you will have to figure all of those things out (and more). To help you decide how to approach these problems, the single-spa core team has put together a &quot;recommended setup&quot; that gives an opinionated approach to solving the practical problems of microfrontends.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>We recommend a setup that uses in-browser ES modules + import maps (or SystemJS to polyfill these if you need better browser support). This setup has several advantages:</p><ol><li>Common libraries are easy to manage, and are only downloaded once. If you&#x27;re using SystemJS, you can also preload them for a speed boost as well.</li><li>Sharing code / functions / variables is as easy as import/export, just like in a monolithic setup</li><li>Lazy loading applications is easy, which enables you to speed up initial load times</li><li>Each application (AKA microservice, AKA ES module) can be independently developed and deployed. Teams are enabled to work at their own speed, experiment (within reason as defined by the organization), QA, and deploy on thier own schedules. This usually also means that release cycles can be decreased to days instead of weeks or months</li><li>A great developer experience (DX): go to your dev environment and add an import map that points the application&#x27;s url to your localhost. See sections below for details</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="alternatives"></a>Alternatives<a class="hash-link" href="#alternatives" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer">qiankun</a> is a popular alternative to this recommended setup.</li><li><a href="https://github.com/namecheap/ilc" target="_blank" rel="noopener noreferrer">Isomorphic Layout Composer</a> - complete solution for Micro Frontends composition into SPA with SSR support</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="in-browser-versus-build-time-modules"></a>In-browser versus build-time modules<a class="hash-link" href="#in-browser-versus-build-time-modules" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=Jxqiu6pdMSU&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=2" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av83498486/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>An in-browser JavaScript module is when imports and exports are not compiled away by your build tool, but instead are
resolved within the browser. This is different from build-time modules, which are supplied by your node_modules and
compiled away before they touch the browser.</p><p>The way to tell webpack and rollup to leave some dependencies untouched during the build, so that they come from the browser,
is via <a href="https://webpack.js.org/configuration/externals/#root" target="_blank" rel="noopener noreferrer">webpack externals</a> and <a href="https://rollupjs.org/guide/en/#external" target="_blank" rel="noopener noreferrer">rollup externals</a>.</p><p>Here are our recommendations:</p><ol><li>Each single-spa application should be an in-browser Javascript module.</li><li>Each large shared-dependency (ie, the react, vue, or angular libraries) should also be an in-browser module.</li><li>Everything else should be a build-time module.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="import-maps"></a>Import Maps<a class="hash-link" href="#import-maps" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=Lfm2Ge_RUxs&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=3" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av83617496/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p><a href="https://github.com/WICG/import-maps" target="_blank" rel="noopener noreferrer">Import Maps</a> are a browser specification for aliasing &quot;import specifiers&quot; to a URL.
An import specifier is the string indicating which module to load. Examples:</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ./thing.js is the import specifier</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> thing </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./thing.js&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// react is the import specifier</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><p>Specifiers that are not a URL are called &quot;bare specifiers,&quot; such as <code>import &#x27;react&#x27;</code>. Being able to alias bare specifiers to a URL
is crucial to being able to use in-browser modules, which is why import maps exist.</p><p>Import Maps are not supported in all browsers. See <a href="https://caniuse.com/import-maps" target="_blank" rel="noopener noreferrer">https://caniuse.com/import-maps</a> for more detail. You can use <a href="https://github.com/systemjs/systemjs" target="_blank" rel="noopener noreferrer">SystemJS</a> or <a href="https://github.com/guybedford/es-module-shims" target="_blank" rel="noopener noreferrer">es-module-shims</a> to polyfill support for import maps.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="module-federation"></a>Module Federation<a class="hash-link" href="#module-federation" title="Direct link to heading">#</a></h2><p><a href="https://dev.to/marais/webpack-5-and-module-federation-4j1i" target="_blank" rel="noopener noreferrer">Module Federation</a> is a webpack-specific technique for sharing <a href="#in-browser-versus-build-time-modules">build-time modules</a>. It involves each microfrontend bundling all of its dependencies, even the shared ones. This means that there are multiple copies of each shared dependency - one per microfrontend. In the browser, the first copy of the shared dependency will be downloaded, but subsequent microfrontends will reuse that shared dependency without downloading their copy of it.</p><p>Note that Module Federation is a new feature (at the time of this writing) and requires that you use webpack@&gt;=5. It is still an evolving technology.</p><p>single-spa is a way of structuring your routes for microfrontends. Module Federation is a performance technique for microfrontends. They complement each other well and can be used together. Here is a <a href="https://www.youtube.com/watch?v=wxnwPLLIJCY" target="_blank" rel="noopener noreferrer">YouTube video</a> by a community member that talks about using single-spa and module federation together.</p><p>With module federation, you must choose how you wish to load the microfrontends themselves. The single-spa core team recommends using SystemJS + import maps as a module loader for the microfrontends. Alternatively, you may use global variables and <code>&lt;script&gt;</code> elements. An example of using SystemJS to load microfrontends with module federation can be found at <a href="https://github.com/ScriptedAlchemy/mfe-webpack-demo/pull/2" target="_blank" rel="noopener noreferrer">https://github.com/ScriptedAlchemy/mfe-webpack-demo/pull/2</a>.</p><p>The single-spa core team recommends choosing either import maps or module federation for your shared, third-party dependencies. We do not recommend sharing some third-party dependencies via import map and others via module federation. When choosing between the two approaches, we have a preference towards import maps, but no objection to module federation. See the <a href="#shared-dependencies">shared dependencies section</a> for a comparison.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="systemjs"></a>SystemJS<a class="hash-link" href="#systemjs" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=AmdKF2UhFzw&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=7" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av83620028/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>SystemJS provides polyfill-like behavior for import maps and in-browser modules. It is not a true polyfill of import maps, due to limitations of the JavaScript language in polyfilling the resolution of bare import specifiers to URLs.</p><p>Since SystemJS is only polyfill-like, you&#x27;ll need to compile your applications into <a href="https://github.com/systemjs/systemjs/blob/master/docs/system-register.md">System.register format</a> instead of to ESM format. This allows for in-browser modules to be fully emulated in environments that don&#x27;t support modules or import maps.</p><p>To compile your code to System.register format, set webpack&#x27;s <a href="https://webpack.js.org/configuration/output/#outputlibrarytarget" target="_blank" rel="noopener noreferrer"><code>output.libraryTarget</code></a> to <code>&quot;system&quot;</code>, or set rollup&#x27;s <a href="https://rollupjs.org/guide/en/#outputformat" target="_blank" rel="noopener noreferrer"><code>format</code></a> to <code>&quot;system&quot;</code>.</p><p>Shared dependencies like React, Vue, and Angular, do not publish System.register versions of their libraries. However, you can find System.register versions of the libraries in <a href="https://github.com/esm-bundle" target="_blank" rel="noopener noreferrer">the esm-bundle project</a> (<a href="https://medium.com/@joeldenning/an-esm-bundle-for-any-npm-package-5f850db0e04d" target="_blank" rel="noopener noreferrer">blog post</a>). Alternatively, SystemJS is capable of loading them via <a href="https://github.com/systemjs/systemjs#2-systemjs-loader" target="_blank" rel="noopener noreferrer">global loading</a> or <a href="https://github.com/systemjs/systemjs#extras" target="_blank" rel="noopener noreferrer">the AMD and named-exports extras</a>.</p><p>An alternative to SystemJS that provides polyfill behavior for import maps is <a href="https://github.com/guybedford/es-module-shims" target="_blank" rel="noopener noreferrer">es-module-shims</a>. This has the advantage of using truly native ES modules. However, it is not the single-spa core team&#x27;s recommended approach for production applications, since it requires less-performant in browser parsing and modification of all your bundles.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="lazy-loading"></a>Lazy loading<a class="hash-link" href="#lazy-loading" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=-LkvBMpCK-A&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=8" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av83620658/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>Lazy loading is when you only download JavaScript code that the user needs for the current page, instead of all JavaScript up front. It is a technique for improving the performance of your application by decreasing the time-to-meaningful-render when you initially load the page. If you use <a href="/docs/configuration#loading-function-or-application">single-spa loading functions</a>, you already have built-in lazy loading for your applications and parcels. Since an application is an &quot;in-browser module,&quot; this means that you are only downloading the in-browser modules in your import map when you need them.</p><p>Often, the route-based lazy loading provided by single-spa loading functions is all that you need to ensure great performance. However, it is also possible to do lazy loading via &quot;code splits&quot; with your bundler (webpack or rollup). For documentation on webpack code splits, see <a href="https://webpack.js.org/guides/code-splitting/#dynamic-imports" target="_blank" rel="noopener noreferrer">these docs</a>. It is recommended to use dynamic import (<code>import()</code>) instead of multiple entry points for code splits in a single-spa application. For code splits to work properly, you&#x27;ll need to <a href="https://webpack.js.org/guides/public-path/#on-the-fly" target="_blank" rel="noopener noreferrer">dynamically set your public path</a>. A tool exists to help you set your public path correctly for use with systemjs - <a href="https://github.com/joeldenning/systemjs-webpack-interop" target="_blank" rel="noopener noreferrer">https://github.com/joeldenning/systemjs-webpack-interop</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="local-development"></a>Local development<a class="hash-link" href="#local-development" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=vjjcuIxqIzY&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=4" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av83617789/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>In contrast to monolithic frontend applications, local development with single-spa encourages only running the one microfrontend you&#x27;re working on, while using deployed versions of all other microfrontends. This is important because running every single-spa microfrontend every time you want to do anything is unwieldy and cumbersome.</p><p>To accomplish local development of only one microfrontend at a time, we can customize the URL for that microfrontend within the import map. For example, the following import map is set up for local development of the <code>navbar</code> application, since that&#x27;s the only one pointing to a local web server. The <code>planets</code> and <code>things</code> applications are pointing to deployed (already hosted) versions of the applications.</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;imports&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;@react-mf/navbar&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://localhost:8080/react-mf-navbar.js&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;@react-mf/planets&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://react.microfrontends.app/planets/2717466e748e53143474beb6baa38e3e5320edd7/react-mf-planets.js&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;@react-mf/things&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://react.microfrontends.app/things/7f209a1ed9ac9690835c57a3a8eb59c17114bb1d/react-mf-things.js&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><p>A tool called <a href="https://github.com/joeldenning/import-map-overrides" target="_blank" rel="noopener noreferrer">import-map-overrides</a> exists to customize your import map through an in-browser UI. This tool will automatically let you toggle one or more microfrontends between your localhost and the deployed version.</p><p>Alternatively, you can use <a href="https://github.com/single-spa/standalone-single-spa-webpack-plugin" target="_blank" rel="noopener noreferrer">standalone-single-spa-webpack-plugin</a>, which allows you to develop each application in standalone mode. Another alternative is to always run the single-spa root config locally, in addition to whichever microfrontends you&#x27;re developing.</p><p>The single-spa core team recommends development on deployed environments via import-map-overrides, as we find that to be the best developer experience, since it allows you to only start one project at a time while also ensuring there&#x27;s no difference between the local environment and fully-integrated deployed environment. However, there are cases when running the root config locally or using standalone-single-spa-webpack-plugin can be useful.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="build-tools-webpack--rollup"></a>Build tools (Webpack / Rollup)<a class="hash-link" href="#build-tools-webpack--rollup" title="Direct link to heading">#</a></h2><p>Tutorial video: <a href="https://www.youtube.com/watch?v=I6COIg-2lyM&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=9" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av84104639/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>It is highly encouraged to use a bundler such as webpack, rollup, parceljs, pikapack, etc. Webpack is an industry-standard for compiling many JavaScript source files into one or more production JavaScript bundles.</p><p>Below are some tips for configuring your bundler to be consumable by SystemJS and single-spa. Note that if you&#x27;re using <a href="/docs/create-single-spa">create-single-spa</a> that these are all set up for you. We leave these instructions here not to overwhelm you with webpack configuration hell, but rather to help you if you choose not to use create-single-spa.</p><ol><li>Set the output target to <code>system</code>. In webpack, this is done via <a href="https://webpack.js.org/configuration/output/#outputlibrarytarget" target="_blank" rel="noopener noreferrer"><code>output.libraryTarget</code></a></li><li>Use a single <a href="https://webpack.js.org/concepts/entry-points/#root" target="_blank" rel="noopener noreferrer">entry point</a>, with <a href="https://webpack.js.org/guides/code-splitting/#dynamic-imports" target="_blank" rel="noopener noreferrer">dynamic imports</a> for any code splitting that you&#x27;d like to accomplish. This best matches the &quot;one bundled project = one in-browser module&quot; paradigm encouraged by the single-spa core team.</li><li>Do not use webpack&#x27;s <a href="https://webpack.js.org/configuration/optimization/#root" target="_blank" rel="noopener noreferrer"><code>optimization</code></a> configuration options, as they make it harder to load the outputted JavaScript files as a single in-browser JavaScript module. Doing so does not make your bundle less optimized - dynamic imports are a viable strategy for accomplishing optimized bundles.</li><li>Follow <a href="https://github.com/systemjs/systemjs#compatibility-with-webpack" target="_blank" rel="noopener noreferrer">the systemjs docs for webpack</a>.</li><li>Consider using <a href="https://github.com/joeldenning/systemjs-webpack-interop" target="_blank" rel="noopener noreferrer">systemjs-webpack-interop</a> to create or verify your webpack config.</li><li>Use <a href="https://github.com/joeldenning/systemjs-webpack-interop" target="_blank" rel="noopener noreferrer">systemjs-webpack-interop</a> to <a href="https://webpack.js.org/guides/public-path/#on-the-fly" target="_blank" rel="noopener noreferrer">set your webpack public path &quot;on the fly&quot;</a>.</li><li>Do not set webpack <a href="https://webpack.js.org/configuration/output/#outputlibrary" target="_blank" rel="noopener noreferrer"><code>output.library</code></a>. SystemJS does not need a name, and in fact does not support named modules without additional configuration.</li><li>Consider turning off <a href="https://webpack.js.org/configuration/output/#outputfilename" target="_blank" rel="noopener noreferrer">webpack hashing</a> for both entry and code split bundles. It is often easier to add in a commit hash during deployment of your microfrontend via your CI environment variables.</li><li>Configure webpack-dev-server to not do host checks. (<a href="https://webpack.js.org/configuration/dev-server/#devserverdisablehostcheck" target="_blank" rel="noopener noreferrer">docs</a>).</li><li>Configure webpack-dev-server for CORS by setting <code>{headers: {&#x27;Access-Control-Allow-Origin&#x27;: &#x27;*&#x27;}}</code>. (<a href="https://stackoverflow.com/questions/31602697/webpack-dev-server-cors-issue" target="_blank" rel="noopener noreferrer">docs</a>)</li><li>If developing on https, <a href="https://webpack.js.org/configuration/dev-server/#devserverhttps" target="_blank" rel="noopener noreferrer">configure webpack-dev-server for HTTPS</a>. Also consider <a href="https://stackoverflow.com/questions/7580508/getting-chrome-to-accept-self-signed-localhost-certificate" target="_blank" rel="noopener noreferrer">trusting SSL certificates from localhost</a>.</li><li>Make sure that your <a href="https://webpack.js.org/configuration/externals/#root" target="_blank" rel="noopener noreferrer">webpack externals</a> are correctly configured for any shared, in-browser modules that you are importing.</li><li>Set <a href="https://webpack.js.org/configuration/output/#outputjsonpfunction" target="_blank" rel="noopener noreferrer">output.jsonpFunction</a> to be a unique string for this project. Since you&#x27;ll have multiple webpack bundles running in the same browser tab, a collision of the <code>jsonpFunction</code> could result in webpack modules getting mixed between bundles.</li><li>Set <a href="https://webpack.js.org/configuration/dev-server/#devserversockport" target="_blank" rel="noopener noreferrer">sockPort</a>, <a href="https://webpack.js.org/configuration/dev-server/#devserversockpath" target="_blank" rel="noopener noreferrer">sockPath</a>, and <a href="https://webpack.js.org/configuration/dev-server/#devserversockhost" target="_blank" rel="noopener noreferrer">sockHost</a> inside of your <code>devServer</code> configuration.</li><li>For webpack, set <a href="https://webpack.js.org/configuration/output/#outputdevtoolnamespace" target="_blank" rel="noopener noreferrer"><code>output.devtoolNamespace</code></a> to your MFE&#x27;s name. This helps namespace your sourcemaps to each MFE.</li></ol><p>For a bit more information specific to webpack code splits, see <a href="/docs/faq#code-splits">the code splits FAQ</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="utility-modules-styleguide-api-etc"></a>Utility modules (styleguide, API, etc)<a class="hash-link" href="#utility-modules-styleguide-api-etc" title="Direct link to heading">#</a></h2><p>A &quot;utility module&quot; is an in-browser JavaScript module that is not a single-spa application or parcel. In other words, it&#x27;s only purpose is to export functionality for other microfrontends to import.</p><p>Common examples of utility modules include styleguides, authentication helpers, and API helpers. These modules do not need to be registered with single-spa, but are important for maintaining consistency between several single-spa applications and parcels.</p><p>Example code in a utility module:</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// In a repo called &quot;api&quot;, you may export functions from the repo&#x27;s entry file.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// These functions will be available to single-spa application, parcels, and other in-browser modules</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// via an import statement.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">authenticatedFetch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">url</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">fetch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">r</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Maybe do some auth stuff here</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><p>Example code in a single-spa application that is using the utility module:</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Inside of a single-spa application, you can import the functions from the &#x27;api&#x27; repo</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> authenticatedFetch </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@org-name/api&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">useEffect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> abortController </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">AbortController</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">authenticatedFetch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">/api/clients/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">props</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation">clientId</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">signal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> abortController</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">signal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">client</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      abortController</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">abort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">clientId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><p>To make utility modules work, you must ensure that your webpack externals and import map are properly configured. An example of a working styleguide may be found at <a href="https://github.com/vue-microfrontends/styleguide" target="_blank" rel="noopener noreferrer">https://github.com/vue-microfrontends/styleguide</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cross-microfrontend-imports"></a>Cross microfrontend imports<a class="hash-link" href="#cross-microfrontend-imports" title="Direct link to heading">#</a></h2><p>Example - <a href="https://github.com/vue-microfrontends/styleguide/blob/af3eaa70bec7daa74635eb3ec76140fb647b0b14/src/vue-mf-styleguide.js#L5">exporting a shared component</a>, <a href="https://github.com/vue-microfrontends/rate-dogs/blob/fe3196234b9cbd6d627199b03a96e7b5f0285c4b/src/components/rate-dogs.vue#L25">importing a shared component</a>, and <a href="https://github.com/vue-microfrontends/rate-dogs/blob/97489e2acb1de44aca910ef5e3e0a9d2494200c7/vue.config.js#L14">required webpack config</a>.</p><p>You can import and export functions, components, logic, data, event emitters, and environment variables between your microfrontends that are in different git repos and JavaScript bundles. Each microfrontend should have a single <a href="https://webpack.js.org/concepts/entry-points/#root" target="_blank" rel="noopener noreferrer">entry file</a> that serves as the &quot;public interface&quot; that controls what is exposed outside of the microfrontend.</p><p>To make cross microfrontend imports possible, configure your bundler so that the microfrontends are treated as &quot;externals&quot; (<a href="https://webpack.js.org/configuration/externals/#root" target="_blank" rel="noopener noreferrer">webpack docs</a> / <a href="https://rollupjs.org/guide/en/#external" target="_blank" rel="noopener noreferrer">rollup docs</a>). Marking them as externals ensures that they are treated as <a href="#in-browser-versus-build-time-modules">in-browser modules</a> instead of build-time modules.</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Inside of the &quot;entry file&quot; for a utility module called @org-name/auth,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// expose your public interface that other microfrontends can access.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Often this is within the main.js or main.single-spa.js file.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">userHasAccess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> loggedInUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">permissions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">some</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">p</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> userHasAccess </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@org-name/auth&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Inside of a single-spa application, import and use a util function from a different microfrontend</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> showLinkToInvoiceFeature </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">userHasAccess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;invoicing&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// In your webpack config, mark @org-name auth as a webpack external</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  externals</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@org-name/auth&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Alternatively, mark *all* org-name packages as externals</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// externals: [/^@org-name\/.+/]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="shared-dependencies"></a>Shared dependencies<a class="hash-link" href="#shared-dependencies" title="Direct link to heading">#</a></h2><p>For performance, it is crucial that your web app loads large JavaScript libraries only once. Your framework of choice (React, Vue, Angular, etc) should only be loaded on the page a single time.</p><p>It is not advisable to make everything a shared dependency, because shared dependencies must be upgraded at once for every microfrontend that uses them. For small libraries, it is likely acceptable to duplicate them in each microfrontend that uses them. For example, react-router is likely small enough to duplicate, which is nice when you want to upgrade your routing one microfrontend at a time. However, for large libraries like react, momentjs, rxjs, etc, you may consider making them shared dependencies.</p><p>There are two approaches to sharing dependencies:</p><ol><li><a href="#import-maps">In-browser modules with import maps</a></li><li><a href="#module-federation">Build-time modules with module federation</a></li></ol><p>You may use either one, or both. We currently recommend only using import maps, although we have no objection to module federation.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="comparison-of-approaches"></a>Comparison of approaches<a class="hash-link" href="#comparison-of-approaches" title="Direct link to heading">#</a></h3><table><thead><tr><th>Approach</th><th>Share dependencies</th><th>Bundler requirements</th><th>Managing dependencies</th></tr></thead><tbody><tr><td>Import Maps</td><td>Fully supported</td><td>Any bundler</td><td><a href="https://github.com/polyglot-microfrontends/shared-dependencies/blob/master/importmap.json">shared dependecies repo</a></td></tr><tr><td>Module Federation</td><td>Fully supported</td><td>Only webpack@&gt;=5</td><td><a href="https://github.com/ScriptedAlchemy/mfe-webpack-demo/blob/f48ff0bd0b7d62b722ea000e5ded73f0d076a0b7/packages/01-host/webpack.config.js#L47">multiple webpack configs</a></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="sharing-with-import-maps"></a>Sharing with Import Maps<a class="hash-link" href="#sharing-with-import-maps" title="Direct link to heading">#</a></h3><p>To share a dependency between microfrontends with <a href="#import-maps">Import Maps</a>, you should use <a href="https://webpack.js.org/configuration/externals/#root" target="_blank" rel="noopener noreferrer">webpack externals</a>, <a href="https://rollupjs.org/guide/en/#external" target="_blank" rel="noopener noreferrer">rollup externals</a>, or similar. Marking libraries as external tells your bundler to not use the version in your node_modules, but rather to expect the library to exist as an in-browser module.</p><p>To make the shared dependencies available as in-browser modules, they must be present in your import map. A good way of managing them is to create a repository called <code>shared-dependencies</code> that has a partial import map in it. The CI process for that repository updates your deployed import map. Upgrading the shared dependencies can then be achieved by making a pull request to that repository.</p><p>Not all libraries publish their code in a suitable format for SystemJS consumption. In those cases, check <a href="https://github.com/esm-bundle" target="_blank" rel="noopener noreferrer">https://github.com/esm-bundle</a> for a SystemJS version of those libraries. Alternatively, you may use <a href="https://github.com/systemjs/systemjs#extras" target="_blank" rel="noopener noreferrer">SystemJS extras</a> to support UMD bundles, which are often available.</p><p>Another option for finding a suitable version of a library for your import map is to use the JSPM CDN, which provides precompiled SystemJS versions of every package on npm (example: <a href="https://system-cdn.jspm.io/npm:@material-ui/core@4.11.3/index.js">https://system-cdn.jspm.io/npm:@material-ui/core@4.11.3/index.js</a>). See <a href="https://jspm.org/docs/cdn" target="_blank" rel="noopener noreferrer">https://jspm.org/docs/cdn</a> for more info. You can generate an import map for your shared dependencies at <a href="https://generator.jspm.io/" target="_blank" rel="noopener noreferrer">https://generator.jspm.io/</a>.</p><p>An example of a shared-dependencies repo, along with a functioning CI process for it, can be found at <a href="https://github.com/polyglot-microfrontends/shared-dependencies" target="_blank" rel="noopener noreferrer">https://github.com/polyglot-microfrontends/shared-dependencies</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="sharing-with-module-federation"></a>Sharing with Module Federation<a class="hash-link" href="#sharing-with-module-federation" title="Direct link to heading">#</a></h3><p>At the time of this writing, module federation is new and still changing. Check out <a href="https://github.com/joeldenning/mfe-webpack-demo/tree/system" target="_blank" rel="noopener noreferrer">this example repo</a> which uses systemjs to load the microfrontends, but module federation to share <code>react</code>, <code>react-dom</code>, and <code>react-router</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deployment-and-continuous-integration-ci"></a>Deployment and Continuous Integration (CI)<a class="hash-link" href="#deployment-and-continuous-integration-ci" title="Direct link to heading">#</a></h2><p>Tutorial video (Part 1): <a href="https://www.youtube.com/watch?v=QHunH3MFPZs&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=5" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av84100303/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p>Tutorial video (Part 2): <a href="https://www.youtube.com/watch?v=nC7rpDXa4B8&amp;list=PLLUD8RtHvsAOhtHnyGx57EYXoaNsxGrTU&amp;index=6" target="_blank" rel="noopener noreferrer">Youtube</a> / <a href="https://www.bilibili.com/video/av84099642/" target="_blank" rel="noopener noreferrer">Bilibili</a></p><p><a href="https://github.com/single-spa/import-map-deployer/tree/master/examples" target="_blank" rel="noopener noreferrer">Example CI configuration files</a></p><p>Microfrontends are built and deployed completely independently. This means that the git repository, CI, build, and deployments all occur without going through a centralized repository. For this reason, monorepos are not encouraged for microfrontends. CI for monorepos can be configured to only build and deploy the packages that have changed but it is often more complex. Modern CI platforms such as <a href="https://aws.amazon.com/blogs/mobile/set-up-continuous-deployment-and-hosting-for-a-monorepo-with-aws-amplify-console/" target="_blank" rel="noopener noreferrer">AWS Amplify</a> and <a href="https://vercel.com/blog/monorepos" target="_blank" rel="noopener noreferrer">Vercel</a> are starting to have built-in support for monorepos however.</p><p>There are two steps to deploying a microfrontend.</p><ol><li>Uploading production JavaScript bundles to a web server / CDN. It is encouraged to use a CDN such as AWS S3 + Cloudfront, Google Cloud Storage, Microsoft Azure Storage, Digital Ocean Spaces, etc because of their superior availability, caching, and performance due to edge locations. The JavaScript files that you upload are completely static. It is encouraged to always write new files to the CDN instead of overwriting files.</li><li>Updating your import map to point to the newly deployed file.</li></ol><p>The implementation of Step 1 is dependent on the infrastructure you&#x27;re using for your CDN. The AWS CLI (<a href="https://docs.aws.amazon.com/cli/latest/reference/s3/" target="_blank" rel="noopener noreferrer"><code>aws s3 sync</code></a>), Google gsutil (<a href="https://github.com/single-spa/import-map-deployer/blob/master/examples/ci-for-javascript-repo/gitlab-gcp-storage/.gitlab-ci.yml"><code>gsutil cp</code></a>), etc are easy ways of accomplishing this.</p><p>For the implementation of Step 2, you have a choice:</p><p>a) Your CI makes a <code>curl</code> HTTP call to a running instance of <a href="https://github.com/single-spa/import-map-deployer" target="_blank" rel="noopener noreferrer">import-map-deployer</a>, which updates the import map in a concurrent-safe way.
b) Your CI runner pulls down the import map, modify it, and reuploads it.</p><p>The advantage of a) is that it is concurrent-safe for multiple, simultaneous deployments. Without a concurrent-safe solution, there might be multiple processes pulling down and reuploading the import map at the same time, which could result in a race condition where one CI process thinks it successfully updated the import map when in reality the other CI process wrote the import map later, having based its changes on a stale version of the import map.</p><p>The advantage of b) is that it doesn&#x27;t require running the import-map-deployer in your production environment. Ultimately, you should choose whichever option makes sense for your organization.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="applications-versus-parcels-versus-utility-modules"></a>Applications versus parcels versus utility modules<a class="hash-link" href="#applications-versus-parcels-versus-utility-modules" title="Direct link to heading">#</a></h2><p>Single-spa has <a href="/docs/microfrontends-concept#types-of-microfrontends">different categories</a> of microfrontends. It is up to you where and how you use each of them. However, the single-spa core team recommends the following:</p><p><strong>Many route-based single-spa applications, very few single-spa parcels</strong></p><ol><li>Prefer splitting microfrontends by route, instead of by components within a route. This means preferring single-spa applications over single-spa parcels whenever possible. The reason for this is that transitions between routes often involve destroying and recreating most UI state, which means your single-spa applications on different routes do not need to ever share UI state.</li><li>Move fixed navigation menus into their own single-spa applications. Implement their <a href="/docs/configuration#activity-function">activity functions</a> to be active by default, only unmounting for the login page.</li><li>Create utility modules for your core component library / styleguide, for shared authentication / authorization code, and for global error handling.</li><li>If you are only using one framework, prefer framework components (i.e. React, Vue, and Angular components) over single-spa parcels. This is because framework components interop easier with each other than when there is an intermediate layer of single-spa parcels. You can import components between single-spa applications You should only create a single-spa parcel if you need it to work with multiple frameworks.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="inter-app-communication"></a>Inter-app communication<a class="hash-link" href="#inter-app-communication" title="Direct link to heading">#</a></h2><p><em>A good architecture is one in which microfrontends are decoupled and do not need to frequently communicate. Following the guidelines above about applications versus parcels helps you keep your microfrontends decoupled. Route-based single-spa applications inherently require less inter-app communication.</em></p><p>There are three things that microfrontends might need to share / communicate:</p><ol><li>Functions, components, logic, and environment variables.</li><li>API data</li><li>UI state</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="functions-components-logic-and-environment-variables"></a>Functions, components, logic, and environment variables<a class="hash-link" href="#functions-components-logic-and-environment-variables" title="Direct link to heading">#</a></h3><p>We recommend using <a href="#cross-microfrontend-imports">cross microfrontend imports</a> to share functions, components, logic, and environment variables.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="api-data"></a>API Data<a class="hash-link" href="#api-data" title="Direct link to heading">#</a></h3><p>Example - <a href="https://github.com/react-microfrontends/api/blob/c3c336129e920bbc6137f04cce24b718105efed1/src/react-mf-api.js#L3">exporting a <code>fetchWithCache</code> function</a> and <a href="https://github.com/react-microfrontends/people/blob/ad18de9b96b52e6975244e6662becfe13e41a2db/src/utils/api.js#L1">importing the function</a>.</p><p>API data often does not need to be shared between microfrontends, since each single-spa application controls different routes and different routes often have different data. However, occasionally you do need to share API data between microfrontends. An in-memory JavaScript cache of API objects is a solution used by several companies to solve this. For React users, this is similar to Data Fetching with Suspense, where the fetching logic for routes is split out from the component code that uses the data.</p><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Inside of your api utility module, you can lazily fetch data either when another microfrontend calls your exported</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// functions, or eagerly fetch it when the route changes.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> loggedInUserPromise </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">fetch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">r</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">ok</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)">Error getting user, server responded with HTTP </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">r</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation">status</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getLoggedInUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> loggedInUserPromise</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><pre class="mdxCodeBlock_1WSO"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> getLoggedInUser </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@org-name/api&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Inside of app1, you can import something from an &quot;api&quot; utility module</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">getLoggedInUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">user</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;user&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></pre><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ui-state"></a>UI State<a class="hash-link" href="#ui-state" title="Direct link to heading">#</a></h3><p><em>If two microfrontends are frequently passing state between each other, consider merging them. The disadvantages of microfrontends are enhanced when your microfrontends are not isolated modules.</em></p><p>UI State, such as &quot;is the modal open,&quot; &quot;what&#x27;s the current value of that input,&quot; etc. largely does not need to be shared between microfrontends. If you find yourself needing constant sharing of UI state, your microfrontends are likely more coupled than they should be. Consider merging them into a single microfrontend.</p><p>Under the rare circumstances where you do need to share UI state between single-spa applications, an event emitter may be used to do so. Below are a few examples of event emitters that might help you out.</p><ol><li>Observables / Subjects (rxjs) - one microfrontend emits new values to a stream that can be consumed by any other microfrontend. It exports the observable to all microfrontends from its in-browser module, so that others may import it.</li><li>CustomEvents - browsers have a built-in event emitter system that allows you to fire custom events. Check out <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events" target="_blank" rel="noopener noreferrer">this documentation</a> for more information. Firing the events with <code>window.dispatchEvent</code> allows you to subscribe in any other microfrontend with <code>window.addEventListener</code>.</li><li>Any other pub/sub event emitter system.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="state-management"></a>State management<a class="hash-link" href="#state-management" title="Direct link to heading">#</a></h2><p>The single-spa core team cautions against using redux, mobx, and other global state management libraries. However, if you&#x27;d like to use a state management library, we recommend keeping the state management tool specific to a single repository / microfrontend instead of a single store for all of your microfrontends. The reason is that microfrontends are not truly decoupled or framework agnostic if they all must use a global store. You cannot independently deploy a microfrontend if it relies on the global store&#x27;s state to be a specific shape or have specific actions fired by other microfrontends - to do so you&#x27;d have to think really hard about whether your changes to the global store are backwards and forwards compatible with all other microfrontends. Additionally, managing global state during route transitions is hard enough without the complexity of multiple microfrontends contributing to and consuming the global state.</p><p>Instead of a global store, the single-spa core team recommends using local component state for your components, or a store for each of your microfrontends. See the above section &quot;<a href="#inter-app-communication">Inter-app communication</a>&quot; for more related information.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/single-spa/id.single-spa.js.org/blob/master/website/versioned_docs/version-5.x/recommended-setup.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/layout-api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Layout Engine API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Applications API Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#alternatives" class="table-of-contents__link">Alternatives</a></li><li><a href="#in-browser-versus-build-time-modules" class="table-of-contents__link">In-browser versus build-time modules</a></li><li><a href="#import-maps" class="table-of-contents__link">Import Maps</a></li><li><a href="#module-federation" class="table-of-contents__link">Module Federation</a></li><li><a href="#systemjs" class="table-of-contents__link">SystemJS</a></li><li><a href="#lazy-loading" class="table-of-contents__link">Lazy loading</a></li><li><a href="#local-development" class="table-of-contents__link">Local development</a></li><li><a href="#build-tools-webpack--rollup" class="table-of-contents__link">Build tools (Webpack / Rollup)</a></li><li><a href="#utility-modules-styleguide-api-etc" class="table-of-contents__link">Utility modules (styleguide, API, etc)</a></li><li><a href="#cross-microfrontend-imports" class="table-of-contents__link">Cross microfrontend imports</a></li><li><a href="#shared-dependencies" class="table-of-contents__link">Shared dependencies</a><ul><li><a href="#comparison-of-approaches" class="table-of-contents__link">Comparison of approaches</a></li><li><a href="#sharing-with-import-maps" class="table-of-contents__link">Sharing with Import Maps</a></li><li><a href="#sharing-with-module-federation" class="table-of-contents__link">Sharing with Module Federation</a></li></ul></li><li><a href="#deployment-and-continuous-integration-ci" class="table-of-contents__link">Deployment and Continuous Integration (CI)</a></li><li><a href="#applications-versus-parcels-versus-utility-modules" class="table-of-contents__link">Applications versus parcels versus utility modules</a></li><li><a href="#inter-app-communication" class="table-of-contents__link">Inter-app communication</a><ul><li><a href="#functions-components-logic-and-environment-variables" class="table-of-contents__link">Functions, components, logic, and environment variables</a></li><li><a href="#api-data" class="table-of-contents__link">API Data</a></li><li><a href="#ui-state" class="table-of-contents__link">UI State</a></li></ul></li><li><a href="#state-management" class="table-of-contents__link">State management</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" label="FAQ" href="/docs/faq/">FAQ</a></li><li class="footer__item"><a class="footer__link-item" label="Getting Started" href="/docs/getting-started-overview/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" label="API Reference" href="/docs/api/">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" label="User Showcase" href="/users/">User Showcase</a></li><li class="footer__item"><a class="footer__link-item" label="Contributors" href="/contributors/">Contributors</a></li><li class="footer__item"><a href="https://join.slack.com/t/single-spa/shared_invite/zt-mafdeybq-0v1aIm3KKaqyVCT2xeny3Q" target="_blank" rel="noopener noreferrer" class="footer__link-item" label="Chat in Slack">Chat in Slack</a></li><li class="footer__item"><a href="https://twitter.com/Single_spa/" target="_blank" rel="noopener noreferrer" class="footer__link-item" label="Twitter">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/single-spa/single-spa" target="_blank" rel="noopener noreferrer" class="footer__link-item" label="GitHub">GitHub</a></li><li class="footer__item"><a href="https://opencollective.com/single-spa" target="_blank" rel="noopener noreferrer" class="footer__link-item" label="Donate">Donate</a></li><li class="footer__item"><a class="footer__link-item" label="Blog" href="/blog/">Blog</a></li><li class="footer__item footer__item--gh"><iframe title="github" src="https://ghbtns.com/github-btn.html?user=single-spa&amp;repo=single-spa&amp;type=star&amp;count=true&amp;size=small"></iframe></li><li class="footer__item"><a href="/img/icons/148705-essential-collection/license/license.html">License for icons</a></li></ul></div></div><div class="text--center"><img class="footer__logo margin-bottom--sm" alt="single-spa" src="/img/logo-white-bgblue.svg"><div>Originally developed at <a href="https://getcanopy.com">Canopy</a></div>Copyright Â© 2022 single-spa.</div></div></footer></div>
<script src="/styles.0f039106.js"></script>
<script src="/runtime~main.fe7e5f5d.js"></script>
<script src="/main.ff1eb78c.js"></script>
<script src="/1.55780ba8.js"></script>
<script src="/2.953e0b72.js"></script>
<script src="/108.228883a7.js"></script>
<script src="/561a3eb1.cf6dff04.js"></script>
<script src="/17896441.c0dd0527.js"></script>
<script src="/b025bb67.45bb851d.js"></script>
</body>
</html>